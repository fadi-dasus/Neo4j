
//1.Sell a book to a customer
//what is known here is only the customer's name
match(c:Customer)
where c.name="Clause"
match(b:Book)
where b.ISBN="a1"
create (o:Order{date:"2020-04-25", orderNo: apoc.create.uuid()})
create (c)-[pu:PURCHASED{price:100, qty:29, ISBN: "a1"}]->(o)
create (o)-[co:CONTAINED]->(b)
return c





//2.Change the address of a customer
//2.1
match (c:Customer{name:"Peter"})-[l:Lives_In]->(a:Address)
set a.town= 'Ã…rhus'
set a.zip= 8000
set a.street= 'newStreetname'
return c


//2.2
match (c:Customer{name:"Peter"})-[l:Lives_In]->(a:Address)
set a= { town: 'Ã…rhus',zip: 8000, street: 'newStreetname'}
return c




//3.Add an existing author to a book
//here better to changes name of authors to different names and different emails
//since it is difficult to know or copy the uuid
MATCH (b:Book),(a:Author)
WHERE a.name="Poul" AND b.ISBN = "a1"
create (a)-[w:WORTE]->(b)
RETURN b





//4.Retire the "Space Opera" category and assign all books from that category to the parent category.
//Don't assume you know the id of the parent category
match (b:Book)-[i:IS_a]-> (c:Category)
where c.name ="Space Opera"
match (c:Category)-[p:PARENT]->(parent:Category)
set c.name = parent.name
return b



//5.Change a book from Non-fiction to fiction, or vice versa
//Fiction to Non-Fiction
//nothing has been changed
match (b:Book)-[i:IS_a]-> (c:Category)
where c.name ="Fiction"
set c.name = "Non-Fiction"
return b



//6.Retire the "Fantasy and Science Fiction" category and just use either "Fantasy" or "Science Fiction"
//only change the parent?
//or both name and parent?
//we only have fantasy and science fiction as parent in our data
match (c:Category)-[p:PARENT]->(parent:Category)
where  parent.name="Fantasy and Science Fiction"
set parent.name="Science Fiction"
return c



//7.Sell 3 copies of one book and 2 of another in a single order
//7.1 in two steps
match(c:Customer)
where c.name="Clause"
match(b:Book)
where b.ISBN="a1"
create (o:Order{date:"2020-04-25", orderNo: apoc.create.uuid()})
create (c)-[pu:PURCHASED{price:100, qty:3, ISBN: "a1"}]->(o)
create (o)-[co:CONTAINED]->(b)




match(c:Customer), (o:Order)
where c.name="Clause" and o.date="2020-04-25"
match(b:Book)
where b.ISBN="a2"
create (c)-[pu:PURCHASED{price:100, qty:2, ISBN: "a2"}]->(o)
create (o)-[co:CONTAINED]->(b)
return c


//7.2 in one single step :)
match(c:Customer)
where c.name="Fadi"
match(b1:Book)
where b1.ISBN="a1"
match(b2:Book)
where b2.ISBN="a2"
create (o:Order{date:"2020-04-25", orderNo: apoc.create.uuid()})
create (c)-[pu:PURCHASED{price:100, qty:3, ISBN: "a1"}]->(o)
create (o)-[co:CONTAINED]->(b1)

create (c)-[:PURCHASED{price:100, qty:2, ISBN: "a2"}]->(o)
create (o)-[:CONTAINED]->(b2)
return c
